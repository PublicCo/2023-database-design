(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-31e98570"],{"3a0d":function(t,e,s){"use strict";var a=s("b283"),i=s.n(a);i.a},"42a1":function(t,e,s){},6531:function(t,e,s){"use strict";var a=s("42a1"),i=s.n(a);i.a},"9b0c":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("page-layout",{attrs:{title:"个人主页"}},[s("a-card",{attrs:{bordered:!0}},[s("detail-list",[s("h1",{staticClass:"title"},[t._v("个人信息")]),s("a-row",[s("a-col",{attrs:{span:8}},[s("detail-list-item",{staticClass:"item_label",attrs:{term:"姓名"}},[t.editMode?s("a-input",{model:{value:t.edited.name,callback:function(e){t.$set(t.edited,"name",e)},expression:"edited.name"}}):s("span",{staticClass:"info_display"},[t._v(t._s(t.personalInfo.name))])],1)],1),s("a-col",{attrs:{span:8}},[s("detail-list-item",{staticClass:"item_label",attrs:{term:"性别"}},[t.editMode?s("a-input",{model:{value:t.edited.gender,callback:function(e){t.$set(t.edited,"gender",e)},expression:"edited.gender"}}):s("span",{staticClass:"info_display"},[t._v(t._s(t.personalInfo.gender))])],1)],1),s("a-col",{attrs:{span:5}},[s("detail-list-item",{staticClass:"item_label",attrs:{term:"年龄"}},[s("span",{staticClass:"info_display"},[t._v(t._s(t.personalInfo.age))])])],1)],1),s("a-row",[s("a-col",{attrs:{span:8}},[s("detail-list-item",{staticClass:"item_label",attrs:{term:"电话"}},[t.editMode?s("a-input",{model:{value:t.edited.phone_number,callback:function(e){t.$set(t.edited,"phone_number",e)},expression:"edited.phone_number"}}):s("span",{staticClass:"info_display"},[t._v(t._s(t.personalInfo.phone_number))])],1)],1),s("a-col",{attrs:{span:8}},[s("detail-list-item",{staticClass:"item_label",attrs:{term:"身份证号"}},[s("span",{staticClass:"info_display"},[t._v(t._s(t.personalInfo.ID))])])],1),s("a-col",{attrs:{span:8}},[s("detail-list-item",{staticClass:"item_label",attrs:{term:"密码"}},[t.editMode?s("a-input",{model:{value:t.edited.password,callback:function(e){t.$set(t.edited,"password",e)},expression:"edited.password"}}):s("span",{staticClass:"info_display"},[t._v(t._s(t.personalInfo.password))])],1)],1)],1),s("a-row",[s("a-col",{attrs:{span:24}},[s("detail-list-item",{staticClass:"item_label",attrs:{term:"住址"}},[t.editMode?s("a-input",{model:{value:t.edited.address,callback:function(e){t.$set(t.edited,"address",e)},expression:"edited.address"}}):s("span",{staticClass:"info_display"},[t._v(t._s(t.personalInfo.address))])],1)],1)],1),s("a-col",{attrs:{span:3}},[s("a-button-group",[s("a-button",{attrs:{type:"primary"},on:{click:t.toggleEditMode}},[t._v(t._s(t.editMode?"保存":"编辑"))]),t.editMode?s("a-button",{on:{click:t.cancelEditMode}},[t._v("取消")]):t._e()],1)],1)],1),s("a-divider",{staticStyle:{"margin-bottom":"32px"}}),s("detail-list",[s("h1",{staticClass:"title"},[t._v("健康")]),s("a-row",[s("detail-list-item",{staticClass:"item_label",attrs:{term:"健康状态"}},[s("span",{staticClass:"info_display"},[t._v(t._s(t.health.status))])])],1),s("a-row",[s("a-col",{attrs:{span:24}},[s("a-space",{attrs:{size:"middle"}},[s("span",{staticClass:"item_label"},[t._v("疫苗记录: ")]),s("a-select",{staticStyle:{width:"400px"},attrs:{placeholder:"请点击查看"}},t._l(t.health.vaccine_records,(function(e,a){return s("a-select-option",{key:e.vaccine_id,attrs:{value:e.vaccine_id}},[s("template",{slot:"title"},[s("span",{staticClass:"option-label"},[t._v(t._s(e.type))])]),s("div",{staticClass:"option-content"},[s("p",{staticClass:"option-label"},[t._v("记录: "+t._s(a+1))]),t._v(" "),s("p",{staticClass:"option-label"},[t._v("疫苗ID: "+t._s(e.vaccine_id))]),s("p",{staticClass:"option-label"},[t._v("种类: "+t._s(e.type))]),s("p",{staticClass:"option-label"},[t._v("厂家: "+t._s(e.manufacture))]),s("p",{staticClass:"option-label"},[t._v("接种时间: "+t._s(e.vaccinate_time))])])],2)})),1)],1)],1)],1),s("p"),s("a-row",[s("a-col",{attrs:{span:24}},[s("a-space",{attrs:{size:"middle"}},[s("span",{staticClass:"item_label"},[t._v("核酸记录: ")]),s("a-select",{staticStyle:{width:"400px"},attrs:{placeholder:"请点击查看"}},t._l(t.health.nucleic_acid_records,(function(e,a){return s("a-select-option",{key:e.test_tube_ID,attrs:{value:e.test_tube_ID}},[s("template",{slot:"title"},[s("span",{staticClass:"option-label"},[t._v(t._s(e.type))])]),s("div",{staticClass:"option-content"},[s("p",{staticClass:"option-label"},[t._v("记录: "+t._s(a+1))]),t._v(" "),s("p",{staticClass:"option-label"},[t._v("检测试管ID: "+t._s(e.test_tube_ID))]),s("p",{staticClass:"option-label"},[t._v("检测时间: "+t._s(e.test_time))]),s("p",{staticClass:"option-label"},[t._v("检测结果: "+t._s(e.test_result))])])],2)})),1)],1)],1)],1),s("p"),s("a-row",[s("a-col",{attrs:{span:24}},[s("a-space",{attrs:{size:"middle"}},[s("span",{staticClass:"item_label"},[t._v("抗原记录: ")]),s("a-select",{staticStyle:{width:"400px"},attrs:{placeholder:"请点击查看"}},t._l(t.health.antigen_records,(function(e,a){return s("a-select-option",{key:e.test_time,attrs:{value:e.test_time}},[s("template",{slot:"title"},[s("span",{staticClass:"option-label"},[t._v(t._s(e.type))])]),s("div",{staticClass:"option-content"},[s("p",{staticClass:"option-label"},[t._v("记录: "+t._s(a+1))]),t._v(" "),s("p",{staticClass:"option-label"},[t._v("检测时间: "+t._s(e.test_time))]),s("p",{staticClass:"option-label"},[t._v("检测结果: "+t._s(e.test_result))])])],2)})),1)],1)],1)],1)],1),s("a-divider",{staticStyle:{"margin-bottom":"32px"}}),s("detail-list",[s("h1",{staticClass:"title"},[t._v("功能")]),s("a-row",[s("detail-list-item",{attrs:{term:"上传位置信息"}},[s("a-button",{attrs:{type:"primary"},on:{click:t.fetchAndUploadUserPosition}},[t._v("获取经纬度")]),null!==t.position.latitude&&null!==t.position.longitude?s("p",[t._v(" 当前经纬度："+t._s(t.position.longitude)+","+t._s(t.position.latitude)+" ")]):t._e(),s("p",[t._v(" 当前地址："+t._s(t.position.province)+","+t._s(t.position.city)+","+t._s(t.position.district)+","+t._s(t.position.township)+", ")])],1)],1),s("a-row",[s("a-col",{attrs:{span:24}},[s("a-space",{attrs:{size:"middle"}},[s("span",{staticClass:"item_label"},[t._v("举报及反馈: ")]),s("a-button",{attrs:{type:"primary"},on:{click:t.showReportModal}},[t._v("点击打开举报、反馈框")])],1),s("a-modal",{attrs:{title:"举报"},model:{value:t.report.ModalVisible,callback:function(e){t.$set(t.report,"ModalVisible",e)},expression:"report.ModalVisible"}},[s("p",{staticClass:"item_label"},[t._v("请输入举报信息:")]),s("a-textarea",{attrs:{rows:4,placeholder:"100字以内","max-length":100},model:{value:t.report.Message,callback:function(e){t.$set(t.report,"Message",e)},expression:"report.Message"}}),s("p"),s("p",[t._v("系统当前时间:"+t._s(t.report.CurrentSystemTime))]),s("span",{attrs:{slot:"footer"},slot:"footer"},[s("a-button",{attrs:{type:"primary"},on:{click:t.cancelReport}},[t._v("取消")]),s("a-button",{attrs:{type:"primary"},on:{click:t.submitReport}},[t._v("提交")])],1)],1)],1)],1),s("p"),s("a-row",[s("span",{staticClass:"item_label"},[t._v("用户历史举报及反馈: ")]),s("a-button",{attrs:{type:"primary"},on:{click:t.showHistoryReportModal}},[t._v(t._s(t.historyReport.showList?"隐藏列表":"显示列表"))]),t.historyReport.showList?s("a-table",{attrs:{columns:t.historyReportColumns,"data-source":t.historyReport.reports,"row-key":"id"}},[s("a-table-column",{attrs:{title:"时间",dataIndex:"message_time"}}),s("a-table-column",{attrs:{title:"状态",dataIndex:"message_state"}}),s("a-table-column",{attrs:{title:"编号",dataIndex:"message_id"}}),s("a-table-column",{attrs:{title:"内容",dataIndex:"message_content"}})],1):t._e()],1)],1)],1)],1)},i=[],o=(s("99af"),s("b0c0"),s("ac1f"),s("1276"),s("96cf"),s("1da1")),n=s("cebe"),r=s.n(n),c=s("9839"),l=s("5efb"),d=s("0020"),p=s("ed3b"),u=s("c340"),h=s("45eb"),m=s("8bbf"),f=s.n(m),_=s("ec7e"),v=s.n(_),g=s("7424"),b=s("be65"),y=s.n(b),w=s("b775");f.a.use(v.a);var R=u["a"].Item,D={name:"BasicDetail",components:{PageLayout:h["a"],DetailListItem:R,DetailList:u["a"],ASelect:c["d"],ASelectOption:c["d"].Option,AButton:l["a"],ATable:d["a"]},data:function(){return{personalInfo:{name:"",gender:"",age:"",phone_number:"",ID:"",address:"",password:""},edited:{name:"",gender:"",age:"",phone_number:"",ID:"",address:"",password:""},health:{status:"",vaccine_records:[],vaccine_records_num:"",nucleic_acid_records:[],nucleic_acid_records_num:"",antigen_records:[]},report:{ModalVisible:!1,Message:"",CurrentSystemTime:""},historyReport:{reports:[],showList:!1},historyReportColumns:[{title:"时间",dataIndex:"message_time",key:"time"},{title:"状态",dataIndex:"message_state",key:"status"},{title:"编号",dataIndex:"message_id",key:"id"},{title:"内容",dataIndex:"message_content",key:"content"}],position:{longitude:"",latitude:"",address:"",province:"",city:"",district:"",township:"",time:"",pos_id:null},editMode:!1,Authorization:"123",DeliveredUserInfo:[],DeliveredUserHealthStatus:[],DeliveredVaccineRecords:[],DeliveredNucleicAcidRecords:[],DeliveredAntigenReport:[],DeliveredHistoryReport:[]}},mounted:function(){this.fetchAndUploadUserPosition(),this.timer=setInterval(this.fetchAndUploadUserPosition,3e5)},beforeDestroy:function(){clearInterval(this.timer)},created:function(){this.fetchUserInfo(),this.fetchUserHealthStatus(),this.fetchUserVaccineRecords(),this.fetchUserVucleicAcidRecords(),this.fetchUserAntigenRecords()},methods:{getAuthorization:function(){this.Authorization=y.a.get(w["default"]).Authorization.split(" ")[1]},toggleEditMode:function(){this.editMode?""==this.edited.name||""==this.edited.gender||""==this.edited.phone_number||""==this.edited.address?(p["a"].warning({title:"警告",content:"请填写完整信息（不能有空）！"}),this.cancelEditMode()):(this.personalInfo.name=this.edited.name,this.personalInfo.gender=this.edited.gender,this.personalInfo.phone_number=this.edited.phone_number,this.personalInfo.address=this.edited.address,this.personalInfo.password=this.edited.password,this.editMode=!1,this.sendUserInfo(this.edited,this.Authorization)):(this.edited.name=this.personalInfo.name,this.edited.gender=this.personalInfo.gender,this.edited.phone_number=this.personalInfo.phone_number,this.edited.address=this.personalInfo.address,this.edited.password=this.personalInfo.password,this.editMode=!0)},cancelEditMode:function(){this.editMode=!1,this.edited.name="",this.edited.gender="",this.edited.age="",this.edited.phone_number="",this.edited.ID="",this.edited.address="",this.edited.password=""},fetchUserInfo:function(){var t=this;this.getAuthorization(),r.a.get(g["ADDRESS"]+"/GetUserInfo/GetUserInfo",{headers:{Authorization:this.Authorization}}).then((function(e){if("200"==e.data.code){t.DeliveredUserInfo=e.data,t.personalInfo.name=t.DeliveredUserInfo.name,t.personalInfo.gender=t.DeliveredUserInfo.gender,t.personalInfo.phone_number=t.DeliveredUserInfo.phone_number,t.personalInfo.address=t.DeliveredUserInfo.user_address,t.personalInfo.ID=t.DeliveredUserInfo.user_id,t.personalInfo.password=t.DeliveredUserInfo.password;var s=parseInt(t.personalInfo.ID.substring(6,10),10),a=(new Date).getFullYear();t.personalInfo.age=a-s}})).catch((function(t){}))},sendUserInfo:function(t,e){this.getAuthorization(),r.a.post(g["ADDRESS"]+"/ModifyUserInfo/ModifyUserInfo",{},{headers:{Authorization:e},params:{name:t.name,gender:t.gender,password:t.password,phone_number:t.password,user_address:t.address}}).then((function(t){t.data.code})).catch((function(t){}))},fetchUserHealthStatus:function(){var t=this;r.a.get(g["ADDRESS"]+"/UserHealth/GetUserHealthInfo",{headers:{Authorization:this.Authorization}}).then((function(e){"200"==e.data.code&&(t.DeliveredUserHealthStatus=e.data,t.health.status=t.DeliveredUserHealthStatus.current_status)})).catch((function(t){}))},fetchUserVaccineRecords:function(){var t=this;r.a.get(g["ADDRESS"]+"/Vaccine/GetVaccinateRecords",{headers:{Authorization:this.Authorization}}).then((function(e){200===e.status&&(t.DeliveredVaccineRecords=e.data,t.health.vaccine_records=t.DeliveredVaccineRecords.sort((function(t,e){return new Date(e.vaccinate_time)-new Date(t.vaccinate_time)})))})).catch((function(t){}))},fetchUserVucleicAcidRecords:function(){var t=this;r.a.get(g["ADDRESS"]+"/NuclearTest/GetTestInfoByID",{headers:{Authorization:this.Authorization}}).then((function(e){200==e.status&&(t.DeliveredNucleicAcidRecords=e.data,t.health.nucleic_acid_records=t.DeliveredNucleicAcidRecords.sort((function(t,e){return new Date(e.test_result)-new Date(t.test_result)})))})).catch((function(t){}))},fetchUserAntigenRecords:function(){var t=this;r.a.get(g["ADDRESS"]+"/Antigen/GetUserAntigRecords",{headers:{Authorization:this.Authorization}}).then((function(e){"200"==e.data.code&&(t.DeliveredAntigenRecords=e.data,t.health.antigen_records=t.DeliveredAntigenRecords.AntigenRecords.sort((function(t,e){return new Date(e.test_time)-new Date(t.test_time)})))})).catch((function(t){}))},showReportModal:function(){this.cancelReport(),this.report.ModalVisible=!0,this.getCurrentSystemTime()},getCurrentSystemTime:function(){var t=new Date,e=t.getFullYear(),s=t.getMonth()+1,a=t.getDate(),i=t.getHours(),o=t.getMinutes(),n=t.getSeconds();this.report.CurrentSystemTime="".concat(e,"/").concat(s,"/").concat(a," ").concat(i,":").concat(o,":").concat(n)},cancelReport:function(){this.report.ModalVisible=!1,this.report.Message="",this.report.CurrentSystemTime=""},submitReport:function(){this.sendUserReport(this.report,this.Authorization),this.report.ModalVisible=!1,this.fetchUserHistoryReport()},sendUserReport:function(t,e){r.a.post(g["ADDRESS"]+"/Report/Report",{},{params:{content:t.Message,time:t.CurrentSystemTime},headers:{Authorization:e}}).then((function(t){t.status})).catch((function(t){}))},fetchUserHistoryReport:function(){var t=this;r.a.get(g["ADDRESS"]+"/Report/GetSelfReport",{headers:{Authorization:this.Authorization}}).then((function(e){if(200===e.status){t.DeliveredHistoryReport=e.data,t.historyReport.reports=t.DeliveredHistoryReport.Reports;for(var s=0;s<t.historyReport.reports.length;s++)"0"==t.historyReport.reports[s].message_state?t.historyReport.reports[s].state="未处理":t.historyReport.reports[s].state="处理";t.historyReport.reports.sort((function(t,e){var s=new Date(t.time),a=new Date(e.time);return a-s}))}})).catch((function(t){}))},showHistoryReportModal:function(){this.historyReport.showList||this.fetchUserHistoryReport(),this.historyReport.showList=!this.historyReport.showList},getLongitudeLatitudeAndTime:function(){var t=this;navigator.geolocation&&(this.position.latitude="",this.position.longitude="",navigator.geolocation.getCurrentPosition((function(e){var s=e.coords.latitude,a=e.coords.longitude;t.position.latitude=s,t.position.longitude=a;var i=new Date,o=i.getFullYear(),n=i.getMonth()+1,r=i.getDate(),c=i.getHours(),l=i.getMinutes(),d=i.getSeconds();t.position.time="".concat(o,"/").concat(n,"/").concat(r," ").concat(c,":").concat(l,":").concat(d),t.getReverseGeocode(t.position.longitude,t.position.latitude)}),(function(t){})))},getReverseGeocode:function(t,e){var s=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var i,o,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:i="33eaa61b207861b0fe36300c6bf98dfe",o="".concat(t,",").concat(e),n="https://restapi.amap.com/v3/geocode/regeo",f.a.jsonp(n,{key:i,location:o,poitype:"",radius:"",extensions:"all",roadlevel:""}).then((function(t){"1"===t.status&&t.regeocode&&(s.address=t.regeocode.addressComponent,s.position.province=s.address.province,s.position.city=s.address.city,s.position.district=s.address.district,s.position.township=s.address.township,s.position.pos_id=s.address.adcode,s.sendUserPosition(s.position,s.Authorization))}));case 4:case"end":return a.stop()}}),a)})))()},sendUserPosition:function(t,e){r.a.post(g["ADDRESS"]+"/UserRouting/UploadRouting",{},{headers:{Authorization:e},params:{pos_id:t.pos_id,time:t.time}}).then((function(t){t.status})).catch((function(t){}))},fetchAndUploadUserPosition:function(){this.getLongitudeLatitudeAndTime()}}},I=D,C=(s("3a0d"),s("0c7c")),A=Object(C["a"])(I,a,i,!1,null,"4801586c",null);e["default"]=A.exports},b283:function(t,e,s){},c340:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{class:["detail-list","small"===t.size?"small":"large","vertical"===t.layout?"vertical":"horizontal"]},[t.title?s("div",{staticClass:"title"},[t._v(t._s(t.title))]):t._e(),s("a-row",[t._t("default")],2)],1)},i=[],o=(s("a9e3"),s("da05")),n={name:"DetailListItem",props:{term:{type:String,required:!1}},inject:{col:{type:Number}},methods:{renderTerm:function(t,e){return e?t("div",{attrs:{class:"term"}},[e]):null},renderContent:function(t,e){return t("div",{attrs:{class:"content"}},[e])}},render:function(t){var e=this.renderTerm(t,this.$props.term),s=this.renderContent(t,this.$slots.default);return t(o["b"],{props:r[this.col]},[e,s])}},r={1:{xs:24},2:{xs:24,sm:12},3:{xs:24,sm:12,md:8},4:{xs:24,sm:12,md:6}},c={name:"DetailList",Item:n,props:{title:{type:String,required:!1},col:{type:Number,required:!1,default:3},size:{type:String,required:!1,default:"large"},layout:{type:String,required:!1,default:"horizontal"}},provide:function(){return{col:this.col>4?4:this.col}}},l=c,d=(s("6531"),s("0c7c")),p=Object(d["a"])(l,a,i,!1,null,null,null);e["a"]=p.exports},ec7e:function(t,e,s){var a,i,o;(function(s,n){i=[],a=n,o="function"===typeof a?a.apply(e,i):a,void 0===o||(t.exports=o)})(0,(function(){
/**
 * Vue Jsonp By LancerComet at 16:35, 2016.10.17.
 * # Carry Your World #
 *
 * @author: LancerComet
 * @license: MIT
 */
var t=null,e={install:function(e,a){e.jsonp=s,e.prototype.$jsonp=s,"number"===typeof a&&(t=a)}};function s(e,s,n){return s=s||{},n=n||t,new Promise((function(t,r){if("string"!==typeof e)throw new Error('[Vue.jsonp] Type of param "url" is not string.');var c=s.callbackQuery||"callback",l=s.callbackName||"jsonp_"+a();s[c]=l,delete s.callbackQuery,delete s.callbackName;var d=[];Object.keys(s).forEach((function(t){d=d.concat(i(t,s[t]))}));var p=o(d).join("&"),u=null;"number"===typeof n&&(u=setTimeout((function(){_(),h.removeChild(m),delete window[l],r({statusText:"Request Timeout",status:408})}),n)),window[l]=function(e){clearTimeout(u),_(),h.removeChild(m),t(e),delete window[l]};var h=document.querySelector("head"),m=document.createElement("script");function f(t){_(),clearTimeout(u),r({status:400,statusText:"Bad Request"})}function _(){m.removeEventListener("error",f)}m.addEventListener("error",f),m.src=e+(/\?/.test(e)?"&":"?")+p,h.appendChild(m)}))}function a(){return(Math.floor(1e5*Math.random())*Date.now()).toString(16)}function i(t,e){t=t.replace(/=/g,"");var s=[];switch(e.constructor){case String:case Number:case Boolean:s.push(encodeURIComponent(t)+"="+encodeURIComponent(e));break;case Array:e.forEach((function(e){s=s.concat(i(t+"[]=",e))}));break;case Object:Object.keys(e).forEach((function(a){var o=e[a];s=s.concat(i(t+"["+a+"]",o))}));break}return s}function o(t){var e=[];return t.forEach((function(t){"string"===typeof t?e.push(t):e=e.concat(o(t))})),e}return e}))}}]);